<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Genesis Console</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>👁 Console Genesis LIVE</h1>

  <button onclick="sendCommand('ping')">🔄 Ping</button>
  <button onclick="sendCommand('status')">📊 Stato BTC</button>
  <button onclick="sendCommand('sendmail', {
    to: 'baki.ozturk.2000@icloud.com',
    subject: 'Notifica Genesis',
    body: 'Questa è una notifica diretta da Genesis.'
  })">📧 Invia Mail</button>

  <button onclick="sendCommand('revolut', { amount: 50, note: 'Invio test €50' })">💸 Invia €50</button>
  <button onclick="sendCommand('revolut', { amount: 20000, note: 'Invio URGENTE €20.000' })">🚨 Invia €20.000</button>

  <br><br>
  <input id="couponCode" placeholder="Inserisci codice coupon">
  <button onclick="attivaCoupon()">🎟️ Attiva Coupon</button>

  <pre id="output"></pre>

  <script>
    async function sendCommand(command, data = {}) {
      const res = await fetch('/command', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-user': 'Shadow-313-core' // ✅ CORRETTO
        },
        body: JSON.stringify({ command, data })
      });

      const out = await res.json();
      document.getElementById('output').textContent = JSON.stringify(out, null, 2);
    }

    async function attivaCoupon() {
      const code = document.getElementById('couponCode').value;
      const res = await fetch('/api/coupon', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-user': 'Shadow-313-core' // ✅ CORRETTO
        },
        body: JSON.stringify({ code })
      });

      const out = await res.json();
      document.getElementById('output').textContent = JSON.stringify(out, null, 2);
    }
  </script>
</body>
</html>
